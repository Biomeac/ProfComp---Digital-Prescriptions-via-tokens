{% extends "base.html" %}
{% block title %}Patient ASL Information{% endblock %}
{% block head %}{% endblock %}
{% block styles %}
<link href="{{ url_for('static', filename='css/aslregister.css') }}" rel="stylesheet" />
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='js/aslregister.js') }}"></script>
{% endblock %}
{% block body %}
<div class="container">
<div class="container-fluid py-3 ps-0">
  <!-- Header -->
  <div class="d-flex align-items-center border-bottom pb-2 mb-3">
    <div>
      <h3>
        <i class="bi bi-person-fill me-2 fs-3 text-secondary "></i>
        <span class="fw-semibold">Patient Registration for Active Script List</span>
      </h3>
    </div>
    <a href="{{ url_for('views.patient_dashboard') }}" class="btn btn-outline-secondary ms-auto d-none d-md-flex">
      <i class="bi bi-arrow-left"></i>
      {% if user_role == "teacher" %}
          Back to Patient Dashboard
      {% else %}
          Back to Student Dashboard
      {% endif %}
    </a>
  </div>

  <form method="POST">
    {{ form.hidden_tag() }}

    <!-- Section toggle -->
    <div class="d-flex align-items-center mb-2">
      <button type="button" class="btn btn-light btn-collapse me-2" data-bs-toggle="collapse" data-bs-target="#general" aria-controls="general">
        <i class="bi bi-chevron-up"></i>
      </button>
      <span class="small">General</span>
    </div>

    <div id="general" class="collapse show mb-3">
      <h6 class="fw-bold mb-1 ms-1">Personal</h6>
      <div class="container-fluid">
        <!-- Row 1 -->
        <div class="row g-3 mb-1">
          <div class="col-md-6">
            <div class="row">
              <label class="col-sm-4 col-form-label">Family Name</label>
              <div class="col-sm-8">
                <input type="text" class="form-control"
                  value="{{ patient.last_name or (patient.name.split(' ')[-1] if patient.name else '') }}" readonly>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <label class="col-sm-4 col-form-label">Given Name</label>
              <div class="col-sm-8">
                <input type="text" class="form-control"
                  value="{{ patient.given_name or (patient.name.split(' ')[0] if patient.name else '') }}" readonly>
              </div>
            </div>
          </div>
        </div>

        <!-- Row 2 -->
        <div class="row g-3 mb-1">
          <div class="col-md-6">
            <div class="row">
              <label class="col-sm-4 col-form-label">Date of Birth</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" value="{{ patient.dob or '' }}" readonly>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <label class="col-sm-4 col-form-label">Gender</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" value="{{ patient.sex or 'N/A' }}" readonly>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Address -->
      <h6 class="fw-bold mb-1 ms-1">Address</h6>
      <div class="container-fluid">
        <div class="row mb-1">
          <label class="col-sm-2 col-form-label">Street</label>
          <div class="col-sm-10">
            <input type="text" class="form-control" value="{{ patient.address or '' }}" readonly>
          </div>
        </div>
        <div class="row g-3 mb-1">
          <div class="col-md-6">
            <div class="row">
              <label class="col-sm-4 col-form-label">Suburb</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" value="{{ patient.suburb or '' }}" readonly>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <label class="col-sm-4 col-form-label">State</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" value="{{ patient.state or '' }}" readonly>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <label class="col-sm-2 col-form-label">Post Code</label>
          <div class="col-sm-3">
            <input type="text" class="form-control" value="{{ patient.postcode or '' }}" readonly>
          </div>
        </div>
      </div>

      <!-- Contact -->
      <h6 class="fw-bold mb-1 ms-1">Contact</h6>
      <div class="container-fluid">
        <div class="row g-3 mb-1">
          <div class="col-md-6">
            <div class="row">
              <label class="col-sm-4 col-form-label">Mobile</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" value="{{ patient.mobile or '' }}" readonly>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <label class="col-sm-4 col-form-label">Home</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" value="{{ patient.phone or '' }}" readonly>
              </div>
            </div>
          </div>
        </div>
        <div class="row mb-1">
          <label class="col-sm-2 col-form-label">Email</label>
          <div class="col-sm-10">
            <input type="text" class="form-control" value="{{ patient.email or '' }}" readonly>
          </div>
        </div>
      </div>

      <!-- Identifiers -->
      <h6 class="fw-bold mb-1 ms-1">Identifiers</h6>
      <div class="container-fluid">
        <div class="row g-3 mb-1">
          <div class="col-md-6">
            <div class="row">
              <label class="col-sm-4 col-form-label">Medicare</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" value="{{ patient.medicare or '' }}" readonly>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="row">
              <label class="col-sm-4 col-form-label">DVA</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" value="{{ patient.repatriation_number or '' }}" readonly>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ASL Sections -->
    <div class="d-flex align-items-center mb-2">
      <button type="button" class="btn btn-light btn-collapse me-2" data-bs-toggle="collapse" data-bs-target="#contacts" aria-controls="contacts">
        <i class="bi bi-chevron-up"></i>
      </button>
      <span class="small">Contacts</span>
    </div>
    <div id="contacts" class="collapse show mb-3">
      <h6 class="fw-bold mb-1 ms-1">Carer/Agent Details</h6>
      <div class="container-fluid border p-3 rounded">
        <div class="row mb-2">
          <div class="col-md-6">
            {{ form.carer_name.label(class="form-label") }}
            {{ form.carer_name(class="form-control") }}
          </div>
          <div class="col-md-6">
            {{ form.carer_relationship.label(class="form-label") }}
            {{ form.carer_relationship(class="form-control") }}
          </div>
        </div>
        <div class="row mb-2">
          <div class="col-md-6">
            {{ form.carer_mobile.label(class="form-label") }}
            {{ form.carer_mobile(class="form-control") }}
          </div>
          <div class="col-md-6">
            {{ form.carer_email.label(class="form-label") }}
            {{ form.carer_email(class="form-control") }}
          </div>
        </div>
      </div>
    </div>

    <div class="d-flex align-items-center mb-2">
      <button type="button" class="btn btn-light btn-collapse me-2" data-bs-toggle="collapse" data-bs-target="#preferred_contact" aria-controls="preferred_contact">
        <i class="bi bi-chevron-up"></i>
      </button>
      <span class="small">Preferred Contact</span>
    </div>
    <div id="preferred_contact" class="collapse show mb-3">
      <div class="mb-3">
        {{ form.preferred_contact.label }}
        {{ form.preferred_contact(class="form-select") }}
      </div>
    </div>

    <div class="d-flex align-items-center mb-2">
      <button type="button" class="btn btn-light btn-collapse me-2" data-bs-toggle="collapse" data-bs-target="#consent" aria-controls="consent">
        <i class="bi bi-chevron-up"></i>
      </button>
      <span class="small">Consent</span>
    </div>
    <div id="consent" class="collapse show mb-3">
      <div class="mb-3">
        {{ form.consent_status.label }}
        {{ form.consent_status(class="form-select") }}
      </div>
    </div>

    <h6 class="fw-bold mb-1 ms-1">Notes</h6>
    <div class="mb-3">
      {{ form.notes.label }}
      {{ form.notes(class="form-control") }}
    </div>

    <div class="d-flex justify-content-end gap-2">
      <button type="submit" class="btn btn-success">Register</button>
{# <a href="{{ url_for('scenario_dashboard', scenario_id=scenario_id) }}" class="btn btn-secondary">Close</a> #}
    </div>
  </form>
</div>
</div>
{% endblock %}
{% block options_menu %}{% endblock %}
