{% extends "base.html" %}
{% import "views/pt_detail_input.html" as pt_macros %}
{% block title %}Edit Patient Details{% endblock %}

{% block head %}{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/edit_pt.css') }}">
{% endblock %}
{% block scripts %}
    <script src="{{ url_for('static', filename='js/edit_pt.js') }}"></script>
{% endblock %}

{% block body %}
<div class="container">
<div class="row">
<div class="card shadow-lg p-4 col-12 col-lg-9 mx-auto">
    <div class="position-relative mb-4">
        <h3 class="text-center">Patient Details</h3>
        <button id="generatePtDetails" class="btn btn-secondary position-absolute d-none d-md-flex">
            Generate Details
        </button>
    </div>

    <!-- Navigation tabs -->
    <ul class="nav nav-tabs mb-3 d-none d-md-flex" id="formTabs" role="tablist">
        {{ pt_macros.add_tab("basic-details",           "Basic Details",            "basic",       active=True) }}
        {{ pt_macros.add_tab("safety-net",              "Safety Net Details",       "safety-net",  disabled=True) }}
        {{ pt_macros.add_tab("allergies",               "Allergies/Health",         "allergies",   disabled=True) }}
        {{ pt_macros.add_tab("accounts",                "Accounts",                 "accounts",    disabled=True) }}
        {{ pt_macros.add_tab("notes",                   "Notes",                    "notes",       disabled=True) }}
        {{ pt_macros.add_tab("clinical-interventions",  "Clinical Interventions",   "clinical",    disabled=True) }}
        {{ pt_macros.add_tab("sms",                     "SMS",                      "sms",         disabled=True) }}
        {{ pt_macros.add_tab("clubs",                   "Clubs/Providers",          "clubs",       disabled=True) }}
        {{ pt_macros.add_tab("other",                   "Other",                    "others",      disabled=True) }}
    </ul>
    <!-- Dropdown (visible only on small screens) -->
    <div class="dropdown d-lg-none">
        <div class="nav nav-tabs" data-bs-toggle="dropdown">
        <div class="nav-item">
            <a class="nav-link active dropdown-toggle" href="#" id="dropdownMenuLink">
                Basic Details
            </a>
        </div>
        <button id="generatePtDetails" class="btn btn-secondary position-absolute">
            Generate Details
        </button>
        </div>
        <ul class="dropdown-menu" id="dropdownMenu">
            {{ pt_macros.add_ddown("basic-details",           "Basic Details",            "basic",       active=True) }}
            {{ pt_macros.add_ddown("safety-net",              "Safety Net Details",       "safety-net",  disabled=True) }}
            {{ pt_macros.add_ddown("allergies",               "Allergies/Health",         "allergies",   disabled=True) }}
            {{ pt_macros.add_ddown("accounts",                "Accounts",                 "accounts",    disabled=True) }}
            {{ pt_macros.add_ddown("notes",                   "Notes",                    "notes",       disabled=True) }}
            {{ pt_macros.add_ddown("clinical-interventions",  "Clinical Interventions",   "clinical",    disabled=True) }}
            {{ pt_macros.add_ddown("sms",                     "SMS",                      "sms",         disabled=True) }}
            {{ pt_macros.add_ddown("clubs",                   "Clubs/Providers",          "clubs",       disabled=True) }}
            {{ pt_macros.add_ddown("other",                   "Other",                    "others",      disabled=True) }}
        </ul>
    </div>

    <!-- Tab panes -->
    <div class="tab-content">
        <!-- Personal Tab -->
        {{ pt_macros.add_tab_panel("basic-details", "Basic Details", "basic", active=True) }}
            <form>
                <!-- Personal Info -->
                <h5 class="mb-3">Personal</h5>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("lastName", "Surname") }}
                    {{ pt_macros.input_field("givenName", "Given name") }}
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("title", "Title") }}
                    {{ pt_macros.input_field("sex", "Sex") }}
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("dob", "Date of Birth", type="date") }} <!-- Calendar -->
                    {{ pt_macros.input_field("ptNumber", "Patient No") }} <!-- Disabled -->
                </div>

                
                <!-- Contact Info -->
                <h5 class="mb-3">Contact</h5>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("address", "Address", fulllength=True) }}
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("suburb", "Suburb") }}
                    {{ pt_macros.input_select("state", "State", di={
                        "nsw" : "New South Wales",
                        "vic" : "Victoria",
                        "qld" : "Queensland",
                        "wa"  : "Western Australia",
                        "sa"  : "South Australia",
                        "tas" : "Tasmania",
                        "act" : "Australian Capital Territory",
                        "nt"  : "Northern Territory",
                    }) }} <!-- Dropdown -->
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("postcode", "Postcode") }}
                    {{ pt_macros.input_field("phone", "Phone No.", type="tel") }}
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("mobile", "Mobile No.", type="tel") }}
                    {{ pt_macros.input_field("licence", "Licence No.") }}
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_check("smsRepeats", "SMS Repeat Reminders") }}
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_check("smsLastRepeats", "SMS Last Repeat Reminders") }}
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_check("smsOwing", "SMS Owing Reminders") }}
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("email", "Email", type="email", fulllength=True) }}
                </div>

                <!-- Medicare -->
                <h5 class="mb-3">Medicare</h5>
                <div class="row g-3 align-items-center mb-1">
                    <!-- input for medicare number is X-Y (Y is 1 digit) -->
                    <div class="col-2">
                        <label for="medicare" class="form-label form-label-sm">Medicare No.</label>
                    </div>
                    <div class="col-4">
                        <div class="input-group input-group-sm w-100">
                            <input
                                id="medicare"
                                maxlength="9"
                                class="form-control form-control-sm w-75"
                                >
                            <span class="input-group-text">-</span>
                            <input
                                id="medicare-issue"
                                maxlength="1"
                                class="form-control form-control-sm"
                                >
                        </div>
                    </div>
                    {{ pt_macros.input_field("medicareValidTo", "Valid To", attrs='placeholder="mm / yyyy"') }} <!-- Calendar (MM/YY) -->
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("medicareSurname", "Surname") }}
                    {{ pt_macros.input_field("medicareGivenName", "Given name") }}
                </div>

                <!-- Concession -->
                <h5 class="mb-3">Concession</h5>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("concessionNumber", "Concession No.") }}
                    {{ pt_macros.input_field("concessionValidTo", "Valid To", type="date") }} <!-- Calendar -->
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("safetyNetNumber", "Safety Net No.") }}
                    {{ pt_macros.input_field("", "", void=True) }}
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("repatriationNumber", "Repatriation No.") }}
                    {{ pt_macros.input_field("repatriationValidTo", "Valid To", type="date") }} <!-- Calendar -->
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("repatriationType", "Repatriation Type") }}
                    {{ pt_macros.input_field("ndssNumber", "NDSS No.") }}
                </div>

                <!-- My HR -->
                <h5 class="mb-3">My HR</h5>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("ihiNumber", "IHI No.") }}
                    {{ pt_macros.input_field("ihiStatus", "IHI Status") }}
                </div>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("ihiRecordStatus", "Record Status") }}
                </div>

                <!-- Doctor -->
                <h5 class="mb-3">Doctor</h5>
                <div class="row g-3 align-items-center mb-1">
                    {{ pt_macros.input_field("doctor", "Default Doctor") }}
                </div>
            </form>
        </div>

        <!-- Saftey Net Tab -->
        {{ pt_macros.add_tab_panel("safety-net", "Safety Net Details", "safety-net", active=False) }}
            <p>Saftey Net Tab Not implemented</p>
        </div>

        <!-- Allergies Tab -->
        {{ pt_macros.add_tab_panel("allergies", "Allergies/Health", "allergies", active=False) }}
            <p>Allergies Tab Not implemented</p>
        </div>
    </div>

    <!-- Submit -->
    <div class="d-flex flex-row-reverse">
        <button type="cancel" class="col-2-sm col-3 btn btn-warning ms-1">Cancel</button>
        <button type="submit" class="col-2-sm col-3 btn btn-success ms-1">Save</button>
    </div>
</div>

</div>
</div>
{% endblock %}
